# Interview Project

This project automates the steps needed to deploy a sample app project which located at https://github.com/sunsongxp/interview-app.

## Check the result

To start using it, please run `vagrant up` to spawn a Linux server using Virtualbox. This command will also trigger the setup & deployment steps defined by ansible scripts. If you want to run ansible scripts manully again using Vagrant, please run `vagrant provision`.

For staging / production servers, servers definition is located at host_vars

After the installation steps has been completed, point domain `static.sample-project.com` & `sample-project.com` to the ip address of the vagrant machine. Open web browser and check the URL: [main.css](https://static.sample-project.com/main.css)

## TODO

* Monitoring - What to monitor for starter
  - Linux status: system uptime, root password change (raise alert if pasword has been changed), CPU Load, Memory, Disk (raise alert when the disk used up to 80%), Network, processes count, 
  - The processes we care about: database uptime (raise alert if database has been restarted), app uptime
  - Backup battery capacity if necessary

* Log - What to Log for starter
  - linux syslog
  - access log / error log of nginx
  - slow log of database
  - log generated by app

* HA
  - This project can be changed easily to support setting up multiple web / app servers. At the frontend, we can either setup haproxy or keepalived( support floating ip) for high availablility. (Load Balancer -> web(also serving static content) -> app)

* CI
  - It is interesting to deploy with ansible in jenkins: https://wiki.jenkins.io/display/JENKINS/Ansible+Plugin

## Pre-requisite

Need:

- Ansible 2.1.0

## Installation

- Fetch the roles

```
ansible-galaxy install -r requirements.yml -p roles
```

## Setup & deployment

- A to Z setup

```
ansible-playbook -i inventory.staging -e @vars.staging --ask-vault-pass main.yml
```

- Install only the web components

```
ansible-playbook -i inventory.staging -e @vars.staging --ask-vault-pass setup-web.yml
```

- Deploy only the app (considering the setup is done already)

```
ansible-playbook -i inventory.staging -e @vars.staging --ask-vault-pass deploy.yml
```
